[
   {
      "name": "createSubAcc: should create sub-account successully",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070670725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF+BhQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f8185000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881796203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l78mstgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bf26b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1235
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0w==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d3",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should error if account doesn't exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "account 0xf8BE5a3750B52D50a819B9AE4130AFC02DC6ad27 not found"
         }
      ]
   },
   {
      "name": "createSubAcc: should error if sub-account already exists",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "subaccount already exists",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: admin can add sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "76519607534516821437861218697071563683134054646335188760067526865290199167703",
                     "s": "23833062327491058574648260598821758347906652528643097333109958975869159679101",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "76519607534516821437861218697071563683134054646335188760067526865290199167703",
                     "s": "23833062327491058574648260598821758347906652528643097333109958975869159689101",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjS40AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a72234b8d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "76519607534516821437861218697071563683134054646335188760067526865290199177703",
                     "s": "23833062327491058574648260598821758347906652528643097333109958975869159679101",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+hnnNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0fa19e734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "76519607534516821437861218697071563683134054646335188760067526865290199167703",
                     "s": "23833062327491058574648260598821758347906652528643097333109958975869159679101",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "76519607534516821437861218697071563683134054646335188760067526865290199167703",
                     "s": "23833062327491058574648260598821758347906652528643097333109958975869159679101",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1235
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNM=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d3",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if sub-account doesn't exists",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "76519607534516821437861218697071563683134054646335188760067526865290199167703",
                     "s": "23833062327491058574648260598821758347906652528643097333109958975869159679101",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "subaccount does not exist"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if wrong siger signs the transaction",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "79719670261062905791690907883339185347959626529996437058357703860322549003466",
                     "s": "36293940778966691382349729902571614096650776667000502649862896722133542576497",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS7A/vAChjjlk5Y8J4rGdcetX3LJGIOCyHUIbgyWEunTKUD2ke7NFuq/RagKAjytvjMx4rFKH4cOR3HA/1QRhIXEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b00000000000000000000000000000000000000000000000000000000000000020000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb03fbc00a18e3964e58f09e2b19d71eb57dcb24620e0b21d421b832584ba74ca503da47bb345baafd16a02808f2b6f8ccc78ac5287e1c391dc703fd504612171000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if no permission",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "82569402946997853182355232115890334171171585888330535279706479807073300805349",
                     "s": "39988409735188494254002419852021091589859532612672646966952806434696030150162",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ7aMoDyyKCnTPfiSGlrctxNiEJtkH3CI4lqhfM19+HblWGijSXWu2SoNE5IGmihBiOF8yYCbpVQJwR/MUCkNXhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27b68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e55868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "2",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "106709938888490544065851949172929238212053305108982034624521157375050269187494",
                     "s": "12368870907711559818952665357914308590393033236982485595003240003424861402170",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS+vrr2CljM9p3n2XVJuwfuoUT16tHWYwi/RPoPLiUd2mG1iIaHq7jHJ6FLgwMo3SclyHL3qfOqY3S7sDeDzJtDoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000020000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bebebaf60a58ccf69de7d97549bb07eea144f5ead1d66308bf44fa0f2e251dda61b5888687abb8c727a14b830328dd2725c872f7a9f3aa6374bbb03783cc9b43a000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: no-op if the signer is already a subaccount signer and adding the same permissions",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "82569402946997853182355232115890334171171585888330535279706479807073300805349",
                     "s": "39988409735188494254002419852021091589859532612672646966952806434696030150162",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ7aMoDyyKCnTPfiSGlrctxNiEJtkH3CI4lqhfM19+HblWGijSXWu2SoNE5IGmihBiOF8yYCbpVQJwR/MUCkNXhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27b68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e55868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "46605844441193701575445920243073758818327439294832241590834930767423829778271",
                     "s": "2309253098707434808508234481238443179791613510847297024401136332735177050881",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234567
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ2cJ+SCXspDyTt35MYPgJq3lBNTGLAVKf3oayJrbaR9fBRr9rfjh1v4D8eja89x1oslmOX4idA2TMHMWnW8gSwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAS1oc=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276709f92097b290f24eddf93183e026ade504d4c62c054a7f7a1ac89adb691f5f051afdadf8e1d6fe03f1e8daf3dc75a2c966397e22740d933073169d6f204b01000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000012d687",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountSignerPermissions: acc-admin/sub-account-admin can change permission of subaccount signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "82569402946997853182355232115890334171171585888330535279706479807073300805349",
                     "s": "39988409735188494254002419852021091589859532612672646966952806434696030150162",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ7aMoDyyKCnTPfiSGlrctxNiEJtkH3CI4lqhfM19+HblWGijSXWu2SoNE5IGmihBiOF8yYCbpVQJwR/MUCkNXhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27b68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e55868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "57738407606602993718960338060372553636279793892463620411688005525023438264942",
                     "s": "6302932300356749847349728742139216765449273201430082701250550538610331725491",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ3+mx9ZAyqawKFaeJyKTZwi+xcX/TPTkfqrQIMOPCdpuDe9VUI75pHke1ZpuTpCAxN0vFot0KQYBDU3OyJW9rrMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad277fa6c7d640caa6b028569e2722936708bec5c5ff4cf4e47eaad020c38f09da6e0def55508ef9a4791ed59a6e4e9080c4dd2f168b742906010d4dcec895bdaeb3000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "3",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "3",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "92588065633170357732470790695594024165459755019206778929233803841930837960559",
                     "s": "35032697890996172268181928793918804999307472203075265691516269212621973168268",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS8yy/PFEn63mvSRaR9jIasKSCO91twIF2jtPaskdzSdvTXPN6Oywyc3aYSxsG6o/UHBumNkznpeZUaQTXb4zIIwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bccb2fcf1449fade6bd245a47d8c86ac29208ef75b70205da3b4f6ac91dcd276f4d73cde8ecb0c9cdda612c6c1baa3f50706e98d9339e979951a4135dbe33208c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountSignerPermissions: fails if current user doesn't have permission to update",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "65234910205504220248037789577112192227593129698472458330229577284625277576603",
                     "s": "35345800513185208189652719814844534403734691181938218477732675815951520828457",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ5A5ppW87C9nM1P04oRK+kMWlRDW+R2v2HkIJs7gquWbTiUDnqUPxVlREPhlZgLLaqIF2EbyhuxMtaHV69gBDCkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad279039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "92588065633170357732470790695594024165459755019206778929233803841930837960559",
                     "s": "35032697890996172268181928793918804999307472203075265691516269212621973168268",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS8yy/PFEn63mvSRaR9jIasKSCO91twIF2jtPaskdzSdvTXPN6Oywyc3aYSxsG6o/UHBumNkznpeZUaQTXb4zIIwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bccb2fcf1449fade6bd245a47d8c86ac29208ef75b70205da3b4f6ac91dcd276f4d73cde8ecb0c9cdda612c6c1baa3f50706e98d9339e979951a4135dbe33208c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: acc admin can remove sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "68736196170116382283592717144609203106185541324134800242646149565906015213318",
                     "s": "41460363823577631203132094835999912576082271213975432731876712025874075113635",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "45348017586684429387341497297558518234899684551565388210346932197320112054299",
                     "s": "47105613321908115132865630523290816112488679118083454374222830860838591969288",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAA+L5aN1C1LVCoGbmuQTCvwC3GrSdkQhGBikTOg3j/iNhN23xP4dVC1QdzVVlhmf5StkGgG2gk1RKnvmjA4Be3ioejvLXAMDenOdUPCJpZT5B6hrgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x590141040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27644211818a44ce8378ff88d84ddb7c4fe1d542d5077355596199fe52b641a01b6824d512a7be68c0e017b78a87a3bcb5c03037a739d50f089a594f907a86b808000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: sub-acc admin can remove sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "68736196170116382283592717144609203106185541324134800242646149565906015213318",
                     "s": "41460363823577631203132094835999912576082271213975432731876712025874075113635",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "68736196170116382283592717144609203106185541324134800242646149565906015213318",
                     "s": "41460363823577631203132094835999912576082271213975432731876712025874075113635",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505402896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oKwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a0ac10000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "68736196170116382283592717144609203106185541324134800242646149565906015213318",
                     "s": "41460363823577631203132094835999912576082271213975432731876712025874075113635",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452205804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqrY7CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaad8ec20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "68736196170116382283592717144609203106185541324134800242646149565906015213318",
                     "s": "41460363823577631203132094835999912576082271213975432731876712025874075113635",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "68736196170116382283592717144609203106185541324134800242646149565906015213318",
                     "s": "41460363823577631203132094835999912576082271213975432731876712025874075113635",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123457
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJB",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e241",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if sub acc does not exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "subaccount does not exist"
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if signer does not exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "signer not found",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if current user does not have permission to remove",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "65234910205504220248037789577112192227593129698472458330229577284625277576603",
                     "s": "35345800513185208189652719814844534403734691181938218477732675815951520828457",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ5A5ppW87C9nM1P04oRK+kMWlRDW+R2v2HkIJs7gquWbTiUDnqUPxVlREPhlZgLLaqIF2EbyhuxMtaHV69gBDCkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad279039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "2549899995824552082111400382027873471467197203106922292080465458462472647878",
                     "s": "13994733138551234025880271784935864587229232198901305108935431775593048983948",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwWjMTd7Q8DnyQfxDHOPA2T1kbiB4h80wNW0hghRIbTGHvC8/ljxYYmhjEX9ue0mj94AvYV6+lcRtzEVxmEaSYwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad2705a331377b43c0e7c907f10c738f0364f591b881e21f34c0d5b486085121b4c61ef0bcfe58f16189a18c45fdb9ed268fde00bd857afa5711b73115c6611a498c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "1195041417033383924226773022718671067919879021552",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "74547351014987444117853652846137813527799610786509822556175883546374452195804",
                     "s": "14596110369115301406554906755662558384813730454579723108205394993551505392896",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "no permission",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: acc-admin can change margin type of sub-account",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "111576753122544610934198149751384359775196727553994086048053785577037358545798",
                     "s": "29035605873411929144630227094861978778586379767704138260075816275194765000769",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAA+L5aN1C1LVCoGbmuQTCvwC3GrSf2rjRNjwncQwxgqxJfYlXyTpuUHIRGb5UUW/Ttyym7hkAxkg7yKgFwZ/1teygWy8J91gMQn2wWaFV13WmtukBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d70000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f6ae344d8f09dc430c60ab125f6255f24e9b941c84466f95145bf4edcb29bb864031920ef22a017067fd6d7b2816cbc27dd603109f6c16685575dd69adba4041000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 1
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: sub-acc-admin can change margin type of sub-account",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "81257435002894260245455088087070984385955174000893612612034515047300368038156",
                     "s": "22505676642743970335432237491201854945685322883995619418152292460707337420751",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 1
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "81257435002894260245455088087070984385955174000893612612034515047300368038156",
                     "s": "22505676642743970335432237491201854945685322883995619418152292460707337420751",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "81257435002894260245455088087070984385955174000893612612034515047300368048156",
                     "s": "22505676642743970335432237491201854945685322883995619418152292460707337420751",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er4gHDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512be201c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "81257435002894260245455088087070984385955174000893612612034515047300368038156",
                     "s": "22505676642743970335432237491201854945685322883995619418152292460707337430751",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjO2bfAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b66df000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "2",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "112587505201396652566595357495200832684219739030641403163070520172244516977335",
                     "s": "6310587138243143289291363283513027582833914032614474387299925079082162732191",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "81257435002894260245455088087070984385955174000893612612034515047300368038156",
                     "s": "22505676642743970335432237491201854945685322883995619418152292460707337420751",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123457
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJB",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e241",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if user does not have permissions",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "43436188059119234308220932832885702154130882532617312117724409149565903751214",
                     "s": "52541775142683025395954747087784855324149389998799434280814040823103395163335",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "1420074711680576023973422975549352255068746198311",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "50295146644685058075888782833132123583368846533088153285725707382235881786203",
                     "s": "20584659167187978032482476804483001083499423366390709594188133495556070660725",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "94236955676741778231506703228821260923181176395",
                  "permissions": "4",
                  "signature": {
                     "signer": "1420074711680576023973422975549352255068746198311",
                     "r": "65234910205504220248037789577112192227593129698472458330229577284625277576603",
                     "s": "35345800513185208189652719814844534403734691181938218477732675815951520828457",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ5A5ppW87C9nM1P04oRK+kMWlRDW+R2v2HkIJs7gquWbTiUDnqUPxVlREPhlZgLLaqIF2EbyhuxMtaHV69gBDCkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad279039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "94236955676741778231506703228821260923181176395",
                     "r": "81257435002894260245455088087070984385955174000893612612034515047300368038156",
                     "s": "22505676642743970335432237491201854945685322883995619418152292460707337420751",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "no permission",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   }
]