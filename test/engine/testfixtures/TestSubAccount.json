[
   {
      "name": "createSubAcc: should create sub-account successully",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f8185",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF+BhQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f8185000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bf26b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l78mstgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bf26b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should not create sub-account successully (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1235
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0w==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d3",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAcc: should error if account doesn't exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "account 0xf8BE5a3750B52D50a819B9AE4130AFC02DC6ad27 not found"
         }
      ]
   },
   {
      "name": "createSubAcc: should error if sub-account already exists",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "subaccount already exists",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: admin can add sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xa92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d7",
                     "s": "0x34b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xa92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d7",
                     "s": "0x34b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a72234b8d",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjS40AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a72234b8d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xa92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0fa19e7",
                     "s": "0x34b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+hnnNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0fa19e734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xa92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d7",
                     "s": "0x34b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xa92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d7",
                     "s": "0x34b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1235
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNM=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d3",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if sub-account doesn't exists",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xa92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d7",
                     "s": "0x34b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ6kskCUm9NcCI5zcLBOcN3EvYXr3BC3LkRfyNvGw+fLXNLEJBb+bZ9tlCW+tRQYJl6T0MH37NIuNMaeCGnIjJH0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27a92c902526f4d702239cdc2c139c37712f617af7042dcb9117f236f1b0f9f2d734b10905bf9b67db65096fad45060997a4f4307dfb348b8d31a7821a7223247d000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "subaccount does not exist"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if wrong siger signs the transaction",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb03fbc00a18e3964e58f09e2b19d71eb57dcb24620e0b21d421b832584ba74ca",
                     "s": "0x503da47bb345baafd16a02808f2b6f8ccc78ac5287e1c391dc703fd504612171",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS7A/vAChjjlk5Y8J4rGdcetX3LJGIOCyHUIbgyWEunTKUD2ke7NFuq/RagKAjytvjMx4rFKH4cOR3HA/1QRhIXEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b00000000000000000000000000000000000000000000000000000000000000020000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb03fbc00a18e3964e58f09e2b19d71eb57dcb24620e0b21d421b832584ba74ca503da47bb345baafd16a02808f2b6f8ccc78ac5287e1c391dc703fd504612171000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if no permission",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xb68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e5",
                     "s": "0x5868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ7aMoDyyKCnTPfiSGlrctxNiEJtkH3CI4lqhfM19+HblWGijSXWu2SoNE5IGmihBiOF8yYCbpVQJwR/MUCkNXhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27b68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e55868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xebebaf60a58ccf69de7d97549bb07eea144f5ead1d66308bf44fa0f2e251dda6",
                     "s": "0x1b5888687abb8c727a14b830328dd2725c872f7a9f3aa6374bbb03783cc9b43a",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS+vrr2CljM9p3n2XVJuwfuoUT16tHWYwi/RPoPLiUd2mG1iIaHq7jHJ6FLgwMo3SclyHL3qfOqY3S7sDeDzJtDoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000020000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bebebaf60a58ccf69de7d97549bb07eea144f5ead1d66308bf44fa0f2e251dda61b5888687abb8c727a14b830328dd2725c872f7a9f3aa6374bbb03783cc9b43a000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: no-op if the signer is already a subaccount signer and adding the same permissions",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xb68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e5",
                     "s": "0x5868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ7aMoDyyKCnTPfiSGlrctxNiEJtkH3CI4lqhfM19+HblWGijSXWu2SoNE5IGmihBiOF8yYCbpVQJwR/MUCkNXhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27b68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e55868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6709f92097b290f24eddf93183e026ade504d4c62c054a7f7a1ac89adb691f5f",
                     "s": "0x051afdadf8e1d6fe03f1e8daf3dc75a2c966397e22740d933073169d6f204b01",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234567
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ2cJ+SCXspDyTt35MYPgJq3lBNTGLAVKf3oayJrbaR9fBRr9rfjh1v4D8eja89x1oslmOX4idA2TMHMWnW8gSwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAS1oc=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276709f92097b290f24eddf93183e026ade504d4c62c054a7f7a1ac89adb691f5f051afdadf8e1d6fe03f1e8daf3dc75a2c966397e22740d933073169d6f204b01000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000012d687",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountSignerPermissions: acc-admin/sub-account-admin can change permission of subaccount signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xb68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e5",
                     "s": "0x5868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ7aMoDyyKCnTPfiSGlrctxNiEJtkH3CI4lqhfM19+HblWGijSXWu2SoNE5IGmihBiOF8yYCbpVQJwR/MUCkNXhIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27b68ca03cb22829d33df8921a5adcb71362109b641f7088e25aa17ccd7df876e55868a34975aed92a0d1392069a284188e17cc9809ba55409c11fcc50290d5e12000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x7fa6c7d640caa6b028569e2722936708bec5c5ff4cf4e47eaad020c38f09da6e",
                     "s": "0x0def55508ef9a4791ed59a6e4e9080c4dd2f168b742906010d4dcec895bdaeb3",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ3+mx9ZAyqawKFaeJyKTZwi+xcX/TPTkfqrQIMOPCdpuDe9VUI75pHke1ZpuTpCAxN0vFot0KQYBDU3OyJW9rrMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad277fa6c7d640caa6b028569e2722936708bec5c5ff4cf4e47eaad020c38f09da6e0def55508ef9a4791ed59a6e4e9080c4dd2f168b742906010d4dcec895bdaeb3000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "3",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "3",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xccb2fcf1449fade6bd245a47d8c86ac29208ef75b70205da3b4f6ac91dcd276f",
                     "s": "0x4d73cde8ecb0c9cdda612c6c1baa3f50706e98d9339e979951a4135dbe33208c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS8yy/PFEn63mvSRaR9jIasKSCO91twIF2jtPaskdzSdvTXPN6Oywyc3aYSxsG6o/UHBumNkznpeZUaQTXb4zIIwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bccb2fcf1449fade6bd245a47d8c86ac29208ef75b70205da3b4f6ac91dcd276f4d73cde8ecb0c9cdda612c6c1baa3f50706e98d9339e979951a4135dbe33208c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountSignerPermissions: fails if current user doesn't have permission to update",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x9039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b",
                     "s": "0x4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ5A5ppW87C9nM1P04oRK+kMWlRDW+R2v2HkIJs7gquWbTiUDnqUPxVlREPhlZgLLaqIF2EbyhuxMtaHV69gBDCkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad279039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xccb2fcf1449fade6bd245a47d8c86ac29208ef75b70205da3b4f6ac91dcd276f",
                     "s": "0x4d73cde8ecb0c9cdda612c6c1baa3f50706e98d9339e979951a4135dbe33208c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS8yy/PFEn63mvSRaR9jIasKSCO91twIF2jtPaskdzSdvTXPN6Oywyc3aYSxsG6o/UHBumNkznpeZUaQTXb4zIIwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bccb2fcf1449fade6bd245a47d8c86ac29208ef75b70205da3b4f6ac91dcd276f4d73cde8ecb0c9cdda612c6c1baa3f50706e98d9339e979951a4135dbe33208c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: acc admin can remove sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0x97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d706",
                     "s": "0x5ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x644211818a44ce8378ff88d84ddb7c4fe1d542d5077355596199fe52b641a01b",
                     "s": "0x6824d512a7be68c0e017b78a87a3bcb5c03037a739d50f089a594f907a86b808",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAA+L5aN1C1LVCoGbmuQTCvwC3GrSdkQhGBikTOg3j/iNhN23xP4dVC1QdzVVlhmf5StkGgG2gk1RKnvmjA4Be3ioejvLXAMDenOdUPCJpZT5B6hrgIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x590141040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27644211818a44ce8378ff88d84ddb7c4fe1d542d5077355596199fe52b641a01b6824d512a7be68c0e017b78a87a3bcb5c03037a739d50f089a594f907a86b808000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: sub-acc admin can remove sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0x97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d706",
                     "s": "0x5ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000050000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0x97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d706",
                     "s": "0x5ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a0ac10",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oKwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a0ac10000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0x97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d706",
                     "s": "0x5ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaad8ec",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqrY7CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaad8ec20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0x97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d706",
                     "s": "0x5ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0x97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d706",
                     "s": "0x5ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAQgbsyl3z4ZWb2fwsll5cS2o+WS5f3TvAXLOJQKT3GVQXr7EIASlAx7aPokdfe4m6UI9cGW6m7/QqhUgaDUW9YM5QsHZBEVLi28JOpy4rCGpQyWKMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f000000000000000000000000000000000000000000000000000000000000000040000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b97f74ef0172ce250293dc65505ebec42004a5031eda3e891d7dee26e9423d7065ba9bbfd0aa1520683516f5833942c1d904454b8b6f093a9cb8ac21a943258a3000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123457
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJB",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e241",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if sub acc does not exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "subaccount does not exist"
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if signer does not exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "signer not found",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if current user does not have permission to remove",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x9039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b",
                     "s": "0x4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ5A5ppW87C9nM1P04oRK+kMWlRDW+R2v2HkIJs7gquWbTiUDnqUPxVlREPhlZgLLaqIF2EbyhuxMtaHV69gBDCkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad279039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x05a331377b43c0e7c907f10c738f0364f591b881e21f34c0d5b486085121b4c6",
                     "s": "0x1ef0bcfe58f16189a18c45fdb9ed268fde00bd857afa5711b73115c6611a498c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwWjMTd7Q8DnyQfxDHOPA2T1kbiB4h80wNW0hghRIbTGHvC8/ljxYYmhjEX9ue0mj94AvYV6+lcRtzEVxmEaSYwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad2705a331377b43c0e7c907f10c738f0364f591b881e21f34c0d5b486085121b4c61ef0bcfe58f16189a18c45fdb9ed268fde00bd857afa5711b73115c6611a498c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xa4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc",
                     "s": "0x20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAANFTgq7Nstzsxe2BgJMRL+lJxKPwAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuk0E4xBb+vYemPtLYTMgH/PxT4ihroAtL2SObmvqqx3CBFGw+ShXrnIFnm5qW2wrqONYEZjfMUiQnC3IG3oIUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x59014104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000d15382aecdb2dcecc5ed818093112fe949c4a3f00000000000000000000000001081bb32977cf86566f67f0b25979712da8f964ba4d04e3105bfaf61e98fb4b6133201ff3f14f88a1ae802d2f648e6e6beaab1dc20451b0f92857ae72059e6e6a5b6c2ba8e3581198df3148909c2dc81b7a08500000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "no permission",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x1081bb32977cf86566f67f0b25979712da8f964b": "4",
                        "0xd15382aecdb2dcecc5ed818093112fe949c4a3f0": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: acc-admin can change margin type of sub-account",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf6ae344d8f09dc430c60ab125f6255f24e9b941c84466f95145bf4edcb29bb86",
                     "s": "0x4031920ef22a017067fd6d7b2816cbc27dd603109f6c16685575dd69adba4041",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAA+L5aN1C1LVCoGbmuQTCvwC3GrSf2rjRNjwncQwxgqxJfYlXyTpuUHIRGb5UUW/Ttyym7hkAxkg7yKgFwZ/1teygWy8J91gMQn2wWaFV13WmtukBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d70000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f6ae344d8f09dc430c60ab125f6255f24e9b941c84466f95145bf4edcb29bb864031920ef22a017067fd6d7b2816cbc27dd603109f6c16685575dd69adba4041000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 1
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: sub-acc-admin can change margin type of sub-account",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c",
                     "s": "0x31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 1
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c",
                     "s": "0x31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512be201c",
                     "s": "0x31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er4gHDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512be201c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c",
                     "s": "0x31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b66df",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjO2bfAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b66df000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "2",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0xf8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab7",
                     "s": "0x0df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ/jqRQvV8hS1hk6DEzTWLJGgfyd8KyJ5dXcsMpngq7q3DfOqbka1TiQfk7I281QaGjSZ5t1rhMfLpYFPlrkgPJ8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27f8ea450bd5f214b5864e831334d62c91a07f277c2b227975772c3299e0abbab70df3aa6e46b54e241f93b236f3541a1a3499e6dd6b84c7cba5814f96b9203c9f000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c",
                     "s": "0x31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123457
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJB",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e241",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if user does not have permissions",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e",
                     "s": "0x7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nYAgC3xzt9L17iBySzUsHqxFtomi6KBGZSYbFqU2iyC50KZdDRdMrkzWGv+3iwiBwsTfKQJDdzBepQRC5uXdsxwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27600802df1cedf4bd7b881c92cd4b07ab116da268ba2811994986c5a94da2c82e7429974345d32b933586bfede2c22070b137ca4090ddcc17a94110b9b9776cc7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "signers": {
                        "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x6f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b",
                     "s": "0x2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAPi+WjdQtS1QqBm5rkEwr8Atxq0nbzILUNeH1ZH8QMZC6/mEEvmgKe53TLGwlKhzr2l7y1stgoET7WivS9rnypyGj3oY2GrGE+STl1+vU/+TkF9adQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad27000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad276f320b50d787d591fc40c642ebf98412f9a029ee774cb1b094a873af697bcb5b2d828113ed68af4bdae7ca9c868f7a18d86ac613e493975faf53ff93905f5a75000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                  "permissions": "4",
                  "signature": {
                     "signer": "0xf8be5a3750b52d50a819b9ae4130afc02dc6ad27",
                     "r": "0x9039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b",
                     "s": "0x4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABCBuzKXfPhlZvZ/CyWXlxLaj5ZLAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAD4vlo3ULUtUKgZua5BMK/ALcatJ5A5ppW87C9nM1P04oRK+kMWlRDW+R2v2HkIJs7gquWbTiUDnqUPxVlREPhlZgLLaqIF2EbyhuxMtaHV69gBDCkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964b0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000f8be5a3750b52d50a819b9ae4130afc02dc6ad279039a695bcec2f673353f4e2844afa43169510d6f91dafd8790826cee0aae59b4e25039ea50fc5595110f8656602cb6aa205d846f286ec4cb5a1d5ebd8010c29000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x1081bb32977cf86566f67f0b25979712da8f964b",
                     "r": "0xb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c",
                     "s": "0x31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEIG7Mpd8+GVm9n8LJZeXEtqPlkuzphQRBKfws7PJul3/zcx7/LSVUKfAs1rxUzY1Er35DDHBwvZJVt2KR+OyzoW8BqgkQv/2UHeUNjqodGRjOz/PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000001081bb32977cf86566f67f0b25979712da8f964bb3a6141104a7f0b3b3c9ba5dffcdcc7bfcb49550a7c0b35af153363512bdf90c31c1c2f64956dd8a47e3b2ce85bc06a82442fff6507794363aa87464633b3fcf000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "no permission",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   }
]