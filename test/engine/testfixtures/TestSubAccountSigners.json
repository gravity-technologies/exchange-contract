[
   {
      "name": "createSubAccshould create sub-account successully",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "createSubAccshould not create sub-account successully (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec41ac5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsQaxQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec41ac5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAccshould not create sub-account successully (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb22752977a249",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3oklhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb22752977a24961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAccshould not create sub-account successully (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAccshould not create sub-account successully (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1235
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0w==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d3",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "createSubAccshould error if account doesn't exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "account 0x063a333F858920393652E15F9A23141156407EFD not found"
         }
      ]
   },
   {
      "name": "createSubAccshould error if sub-account already exists",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "subaccount already exists",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: admin can add sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6",
                     "s": "0x300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YZADrg+9TJIcropZSNJzfM+e485iLvNe0FgWgmPVaqmMABUxbr1HMWU94/F6TImU3NXYkc1dzUcqwHOcWkKgPUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6",
                     "s": "0x300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690aa805",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YZADrg+9TJIcropZSNJzfM+e485iLvNe0FgWgmPVaqmMABUxbr1HMWU94/F6TImU3NXYkc1dzUcqwHOcWkKqAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690aa805000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55d1b6",
                     "s": "0x300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YZADrg+9TJIcropZSNJzfM+e485iLvNe0FgWgmPVdG2MABUxbr1HMWU94/F6TImU3NXYkc1dzUcqwHOcWkKgPUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55d1b6300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6",
                     "s": "0x300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YZADrg+9TJIcropZSNJzfM+e485iLvNe0FgWgmPVaqmMABUxbr1HMWU94/F6TImU3NXYkc1dzUcqwHOcWkKgPUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6",
                     "s": "0x300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1235
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YZADrg+9TJIcropZSNJzfM+e485iLvNe0FgWgmPVaqmMABUxbr1HMWU94/F6TImU3NXYkc1dzUcqwHOcWkKgPUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNM=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d3",
            "ret": "eip712 invalid signature: recovery failed"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if sub-account doesn't exists",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6",
                     "s": "0x300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YZADrg+9TJIcropZSNJzfM+e485iLvNe0FgWgmPVaqmMABUxbr1HMWU94/F6TImU3NXYkc1dzUcqwHOcWkKgPUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd86400eb83ef5324872ba29652349cdf33e7b8f3988bbcd7b41605a098f55aaa6300054c5baf51cc594f78fc5e9322653735762473577351cab01ce71690a80f5000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "subaccount does not exist"
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if wrong siger signs the transaction",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xac348a7cb76239f0d9a39a4e6cc51c1a49ded418cd767f27fa6ace2a79ef1d5f",
                     "s": "0x44215b236aa261cfba251b8885a57114eb7a6f1d4abd4ff6beefed3a2e03a80d",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKKw0iny3Yjnw2aOaTmzFHBpJ3tQYzXZ/J/pqzip57x1fRCFbI2qiYc+6JRuIhaVxFOt6bx1KvU/2vu/tOi4DqA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNI=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed6472800000000000000000000000000000000000000000000000000000000000000020000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728ac348a7cb76239f0d9a39a4e6cc51c1a49ded418cd767f27fa6ace2a79ef1d5f44215b236aa261cfba251b8885a57114eb7a6f1d4abd4ff6beefed3a2e03a80d000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: fails if no permission",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0xf9e971326c83bce8be917c5602a8b0678416384cdfed16a571f858bc0b5842a5",
                     "s": "0x2547602a74f80dba2c17b6e122200081496b6ec133af985d5f3066a0d5ec6975",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/fnpcTJsg7zovpF8VgKosGeEFjhM3+0WpXH4WLwLWEKlJUdgKnT4DbosF7bhIiAAgUlrbsEzr5hdXzBmoNXsaXUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efdf9e971326c83bce8be917c5602a8b0678416384cdfed16a571f858bc0b5842a52547602a74f80dba2c17b6e122200081496b6ec133af985d5f3066a0d5ec6975000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xe52c383c3669f1dffbd4236fa01968fccb3e1fccd5d831e5c8aa9c3ef4c7c6ca",
                     "s": "0x619dd831ec0a0c6e457240ac969a0faf60b0ee0ae993836c0b3b5c947b07eec1",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKOUsODw2afHf+9Qjb6AZaPzLPh/M1dgx5ciqnD70x8bKYZ3YMewKDG5FckCslpoPr2Cw7grpk4NsCztclHsH7sEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000020000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728e52c383c3669f1dffbd4236fa01968fccb3e1fccd5d831e5c8aa9c3ef4c7c6ca619dd831ec0a0c6e457240ac969a0faf60b0ee0ae993836c0b3b5c947b07eec1000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "addSubAccountSigner: no-op if the signer is already a subaccount signer and adding the same permissions",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0xf9e971326c83bce8be917c5602a8b0678416384cdfed16a571f858bc0b5842a5",
                     "s": "0x2547602a74f80dba2c17b6e122200081496b6ec133af985d5f3066a0d5ec6975",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/fnpcTJsg7zovpF8VgKosGeEFjhM3+0WpXH4WLwLWEKlJUdgKnT4DbosF7bhIiAAgUlrbsEzr5hdXzBmoNXsaXUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efdf9e971326c83bce8be917c5602a8b0678416384cdfed16a571f858bc0b5842a52547602a74f80dba2c17b6e122200081496b6ec133af985d5f3066a0d5ec6975000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x8919f5312f0f9cdf88bd8b8f4154d65f1299e02e9824db134fb8b70738deda49",
                     "s": "0x05a7fa35f34cab2f2cfb2bdc8267dc5d81e3fdc3803cd928970160b3e7a45246",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 1234567
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/YkZ9TEvD5zfiL2Lj0FU1l8SmeAumCTbE0+4twc43tpJBaf6NfNMqy8s+yvcgmfcXYHj/cOAPNkolwFgs+ekUkYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAS1oc=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efd8919f5312f0f9cdf88bd8b8f4154d65f1299e02e9824db134fb8b70738deda4905a7fa35f34cab2f2cfb2bdc8267dc5d81e3fdc3803cd928970160b3e7a45246000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000012d687",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountSignerPermissions: acc-admin/sub-account-admin can change permission of subaccount signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0xf9e971326c83bce8be917c5602a8b0678416384cdfed16a571f858bc0b5842a5",
                     "s": "0x2547602a74f80dba2c17b6e122200081496b6ec133af985d5f3066a0d5ec6975",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/fnpcTJsg7zovpF8VgKosGeEFjhM3+0WpXH4WLwLWEKlJUdgKnT4DbosF7bhIiAAgUlrbsEzr5hdXzBmoNXsaXUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efdf9e971326c83bce8be917c5602a8b0678416384cdfed16a571f858bc0b5842a52547602a74f80dba2c17b6e122200081496b6ec133af985d5f3066a0d5ec6975000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "2",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "2",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0xf4ce2e211929d17830874677a98e674d923bc1b18d2da423bb130474222ca5e6",
                     "s": "0x5f545ae3e781b47e0e704f29b5e44c282635ec6b21f5fad3b4f0892bcd804e60",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/fTOLiEZKdF4MIdGd6mOZ02SO8GxjS2kI7sTBHQiLKXmX1Ra4+eBtH4OcE8pteRMKCY17Gsh9frTtPCJK82ATmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efdf4ce2e211929d17830874677a98e674d923bc1b18d2da423bb130474222ca5e65f545ae3e781b47e0e704f29b5e44c282635ec6b21f5fad3b4f0892bcd804e60000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "3",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "3",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0x5dd3f97c22b98731e83708a210127a67192f39a96119fecc87c6039e2546b3ad",
                     "s": "0x62add283b473889d0d06decf19f68041267b50d2356e4f4df6554aceb75c3d65",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKF3T+XwiuYcx6DcIohASemcZLzmpYRn+zIfGA54lRrOtYq3Sg7RziJ0NBt7PGfaAQSZ7UNI1bk9N9lVKzrdcPWUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647285dd3f97c22b98731e83708a210127a67192f39a96119fecc87c6039e2546b3ad62add283b473889d0d06decf19f68041267b50d2356e4f4df6554aceb75c3d65000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2",
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountSignerPermissions: fails if current user doesn't have permission to update",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x0bfa0f4316fd280756d4920c44154ee7083d83ed76aa361c89d1c86dc12ec078",
                     "s": "0x1bd1ede9da608e15566eb4415cc1c2203a35f37275a0f380c494f30778a1a963",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Qv6D0MW/SgHVtSSDEQVTucIPYPtdqo2HInRyG3BLsB4G9Ht6dpgjhVWbrRBXMHCIDo183J1oPOAxJTzB3ihqWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efd0bfa0f4316fd280756d4920c44154ee7083d83ed76aa361c89d1c86dc12ec0781bd1ede9da608e15566eb4415cc1c2203a35f37275a0f380c494f30778a1a963000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0x5dd3f97c22b98731e83708a210127a67192f39a96119fecc87c6039e2546b3ad",
                     "s": "0x62add283b473889d0d06decf19f68041267b50d2356e4f4df6554aceb75c3d65",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKF3T+XwiuYcx6DcIohASemcZLzmpYRn+zIfGA54lRrOtYq3Sg7RziJ0NBt7PGfaAQSZ7UNI1bk9N9lVKzrdcPWUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4kA=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647285dd3f97c22b98731e83708a210127a67192f39a96119fecc87c6039e2546b3ad62add283b473889d0d06decf19f68041267b50d2356e4f4df6554aceb75c3d65000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "actor cannot call function",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: acc admin can remove sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xc20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f29",
                     "s": "0x74b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKMIPW6WvQyoI/qLsO7XRFvcHUhghOFApG2DNtyQm8X8pdLXpsxYhBQpAhych2qdygpUHCncwY37eZ/8F22b7ZKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728c20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f2974b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x8e511b2fc714565e21aab3b139a62821f9d8eeaa593486dcabe6723fc2ad4e69",
                     "s": "0x4234901687a3ad9be5add989d3747cc9f08a1dc11ce7842d40e42bf4f7332d9d",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAABjozP4WJIDk2UuFfmiMUEVZAfv2OURsvxxRWXiGqs7E5pigh+djuqlk0htyr5nI/wq1OaUI0kBaHo62b5a3ZidN0fMnwih3BHOeELUDkK/T3My2dAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x590141040000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000500000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728000000000000000000000000063a333f858920393652e15f9a23141156407efd8e511b2fc714565e21aab3b139a62821f9d8eeaa593486dcabe6723fc2ad4e694234901687a3ad9be5add989d3747cc9f08a1dc11ce7842d40e42bf4f7332d9d000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: sub-acc admin can remove sub-account signer",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xc20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f29",
                     "s": "0x74b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKMIPW6WvQyoI/qLsO7XRFvcHUhghOFApG2DNtyQm8X8pdLXpsxYhBQpAhych2qdygpUHCncwY37eZ/8F22b7ZKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728c20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f2974b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000005000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xc20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f29",
                     "s": "0x74b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKMIPW6WvQyoI/qLsO7XRFvcHUhghOFApG2DNtyQm8X8pdLXpsxYhBQpAhych2qdygpUHCncwY37eZ/8F22b7ZKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728c20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f2974b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa9879cbb",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph5y7AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa9879cbb000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2",
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xc20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f29",
                     "s": "0x74b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKMIPW6WvQyoI/qLsO7XRFvcHUhghOFApG2DNtyQm8X8pdLXpsxYhBQpAhych2qdygpUHCncwY37eZ/8F22b7ZKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728c20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f2974b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e9890809",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26YkICTSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e989080934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2",
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xc20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f29",
                     "s": "0x74b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKMIPW6WvQyoI/qLsO7XRFvcHUhghOFApG2DNtyQm8X8pdLXpsxYhBQpAhych2qdygpUHCncwY37eZ/8F22b7ZKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728c20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f2974b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2",
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xc20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f29",
                     "s": "0x74b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAABKZYTe/e3U7IXnM0SvIGjUrtZHKMIPW6WvQyoI/qLsO7XRFvcHUhghOFApG2DNtyQm8X8pdLXpsxYhBQpAhych2qdygpUHCncwY37eZ/8F22b7ZKgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc00000000000000000000000000000000000000000000000000000000000000040000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728c20f5ba5af432a08fea2ec3bb5d116f7075218213850291b60cdb72426f17f2974b5e9b31621050a40872721daa7728295070a7730637ede67ff05db66fb64a8000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123457
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJB",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e241",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2",
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if sub acc does not exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "subaccount does not exist"
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if signer does not exist",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "signer not found",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "2"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "removeAccountSigner: fails if current user does not have permission to remove",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x0bfa0f4316fd280756d4920c44154ee7083d83ed76aa361c89d1c86dc12ec078",
                     "s": "0x1bd1ede9da608e15566eb4415cc1c2203a35f37275a0f380c494f30778a1a963",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Qv6D0MW/SgHVtSSDEQVTucIPYPtdqo2HInRyG3BLsB4G9Ht6dpgjhVWbrRBXMHCIDo183J1oPOAxJTzB3ihqWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efd0bfa0f4316fd280756d4920c44154ee7083d83ed76aa361c89d1c86dc12ec0781bd1ede9da608e15566eb4415cc1c2203a35f37275a0f380c494f30778a1a963000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x554d798dce3968e2f42bb71badcc4c43996d8b049ce635ce5c988a48995a0f7d",
                     "s": "0x3a8bbe18d6d7e3307f50a647d895225363097053042b603747ce7a6bc1e945d7",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/VVNeY3OOWji9Cu3G63MTEOZbYsEnOY1zlyYikiZWg99Oou+GNbX4zB/UKZH2JUiU2MJcFMEK2A3R856a8HpRdcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efd554d798dce3968e2f42bb71badcc4c43996d8b049ce635ce5c988a48995a0f7d3a8bbe18d6d7e3307f50a647d895225363097053042b603747ce7a6bc1e945d7000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "5",
            "tx": {
               "trace_id": "0",
               "tx_id": "5",
               "time": "1",
               "type": "REMOVE_SUB_ACCOUNT_SIGNER",
               "remove_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xf9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f9",
                     "s": "0x34a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "WQFBBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFTY2KH7f7X/DFhOvqdgWsazSVv8AAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyj5yS15g0AokzdK50G5lKjCtohp4oamlF3aSdO26Yjg+TSkM1B/hKkz2EjK0S4yUCrzKs/fjzJFIhIpmA+ph3WrAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x5901410400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000054d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc0000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728f9c92d7983402893374ae741b994a8c2b68869e286a6945dda49d3b6e988e0f934a433507f84a933d848cad12e32502af32acfdf8f3245221229980fa98775ab000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "no permission",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        "0x4a6584defdedd4ec85e73344af2068d4aed64728": "4",
                        "0x54d8d8a1fb7fb5ff0c584ebea7605ac6b3495bfc": "4"
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: acc-admin can change margin type of sub-account",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0xaccc99308bebbb13e474fc83434baa1692661e1962c8a9f5954d099b75e98ba9",
                     "s": "0x30677b743578a9e44ee85957f2903de20c924fc1f82bc2fbafdf3d6cc4ccfa4a",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAABjozP4WJIDk2UuFfmiMUEVZAfv2szJkwi+u7E+R0/INDS6oWkmYeGWLIqfWVTQmbdemLqTBne3Q1eKnkTuhZV/KQPeIMkk/B+CvC+6/fPWzEzPpKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d70000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efdaccc99308bebbb13e474fc83434baa1692661e1962c8a9f5954d099b75e98ba930677b743578a9e44ee85957f2903de20c924fc1f82bc2fbafdf3d6cc4ccfa4a000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 1
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: sub-acc-admin can change margin type of sub-account",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xa983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e3093",
                     "s": "0x3a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyipg9Ip/CQu8O+rNxLAoD7vLFX0ovMB/q9aziKusZ4wkzoV2Y90nt/d46oB1313Sf4JuwsRogSFJM0Lx2hCKjfSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728a983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e30933a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 1
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong V)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xa983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e3093",
                     "s": "0x3a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyipg9Ip/CQu8O+rNxLAoD7vLFX0ovMB/q9aziKusZ4wkzoV2Y90nt/d46oB1313Sf4JuwsRogSFJM0Lx2hCKjfSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728a983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e30933a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong R)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xa983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e57a3",
                     "s": "0x3a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyipg9Ip/CQu8O+rNxLAoD7vLFX0ovMB/q9aziKusZ5XozoV2Y90nt/d46oB1313Sf4JuwsRogSFJM0Lx2hCKjfSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728a983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e57a33a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong S)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xa983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e3093",
                     "s": "0x3a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a5ee2",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyipg9Ip/CQu8O+rNxLAoD7vLFX0ovMB/q9aziKusZ4wkzoV2Y90nt/d46oB1313Sf4JuwsRogSFJM0Lx2hCKl7iAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728a983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e30933a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a5ee2000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if invalid signature (Wrong nonce)",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "2",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a3982",
                     "s": "0x77f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c",
                     "v": 28,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Z8OWqOMzDdIi1YcluClVg24jvw26Lyj1m6Cj2nQKjmCd/BaPeEE+hpx4RaBY/wSV1v4FeIdvlsWVu52v8N7KhwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd9f0e5aa38ccc37488b561c96e0a5560db88efc36e8bca3d66e828f69d02a398277f05a3de104fa1a71e1168163fc12575bf815e21dbe5b1656ee76bfc37b2a1c000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xa983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e3093",
                     "s": "0x3a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123457
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyipg9Ip/CQu8O+rNxLAoD7vLFX0ovMB/q9aziKusZ4wkzoV2Y90nt/d46oB1313Sf4JuwsRogSFJM0Lx2hCKjfSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJB",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728a983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e30933a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e241",
            "ret": "eip712 invalid signature: recovery failed",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   },
   {
      "name": "setSubAccountMarginType: fails if user does not have permissions",
      "steps": [
         {
            "time": "1",
            "tx_id": "1",
            "tx": {
               "trace_id": "0",
               "tx_id": "1",
               "time": "1",
               "type": "CREATE_ACCOUNT",
               "create_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe",
                     "s": "0x212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "htsA4QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79Rs5Z2ElMC0YWvnyjigfpxsLosxZYUZx/6FQAS/m7Qv4hLSqQdvSDvp9KlLLEwEoAPKmaONg616jz1mK8Xxy2gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x86db00e100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000063a333f858920393652e15f9a23141156407efd46ce59d8494c0b4616be7ca38a07e9c6c2e8b31658519c7fe854004bf9bb42fe212d2a9076f483be9f4a94b2c4c04a003ca99a38d83ad7a8f3d662bc5f1cb680000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "address": "0x063a333f858920393652e15f9a23141156407efd",
                     "signers": {
                        "0x063a333f858920393652e15f9a23141156407efd": "2"
                     }
                  },
                  "name": "ExAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "2",
            "tx": {
               "trace_id": "0",
               "tx_id": "2",
               "time": "1",
               "type": "CREATE_SUB_ACCOUNT",
               "create_sub_account": {
                  "account": "0x063a333f858920393652e15f9a23141156407efd",
                  "sub_account_id": "1",
                  "quote_currency": "USDT",
                  "margin_type": "SIMPLE_CROSS_MARGIN",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b39",
                     "s": "0x61769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 1234
                  }
               }
            },
            "tx_abi": "HDih8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAY6Mz+FiSA5NlLhX5ojFBFWQH79WBSVIK0oep8AUa8ajvDL49s/QhZ6pEtiWfsidSl3ezlhdp4rQCiMiB1vNZLencMg3/P893vyCt3GjuUiTsPztQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABNIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0g==",
            "tx_data": "0x1c38a1f000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000063a333f858920393652e15f9a23141156407efd58149520ad287a9f0051af1a8ef0cbe3db3f42167aa44b6259fb227529777b3961769e2b40288c881d6f3592de9dc320dff3fcf77bf20addc68ee5224ec3f3b5000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d200000000000000000000000000000000000000000000000000000000000004d2",
            "ret": "",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "signers": {
                        
                     }
                  },
                  "name": "ExSubAccountSigners"
               }
            ]
         },
         {
            "time": "1",
            "tx_id": "3",
            "tx": {
               "trace_id": "0",
               "tx_id": "3",
               "time": "1",
               "type": "ADD_SUB_ACCOUNT_SIGNER",
               "add_sub_account_signer": {
                  "sub_account_id": "1",
                  "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                  "permissions": "4",
                  "signature": {
                     "signer": "0x063a333f858920393652e15f9a23141156407efd",
                     "r": "0x0bfa0f4316fd280756d4920c44154ee7083d83ed76aa361c89d1c86dc12ec078",
                     "s": "0x1bd1ede9da608e15566eb4415cc1c2203a35f37275a0f380c494f30778a1a963",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 12345
                  }
               }
            },
            "tx_abi": "/E1a6wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEplhN797dTsheczRK8gaNSu1kcoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAGOjM/hYkgOTZS4V+aIxQRVkB+/Qv6D0MW/SgHVtSSDEQVTucIPYPtdqo2HInRyG3BLsB4G9Ht6dpgjhVWbrRBXMHCIDo183J1oPOAxJTzB3ihqWMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDk=",
            "tx_data": "0xfc4d5aeb0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed647280000000000000000000000000000000000000000000000000000000000000004000000000000000000000000063a333f858920393652e15f9a23141156407efd0bfa0f4316fd280756d4920c44154ee7083d83ed76aa361c89d1c86dc12ec0781bd1ede9da608e15566eb4415cc1c2203a35f37275a0f380c494f30778a1a963000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d20000000000000000000000000000000000000000000000000000000000003039",
            "ret": ""
         },
         {
            "time": "1",
            "tx_id": "4",
            "tx": {
               "trace_id": "0",
               "tx_id": "4",
               "time": "1",
               "type": "SET_SUB_ACCOUNT_MARGIN_TYPE",
               "set_sub_account_margin_type": {
                  "sub_account_id": "1",
                  "margin_type": "ISOLATED_MARGIN",
                  "signature": {
                     "signer": "0x4a6584defdedd4ec85e73344af2068d4aed64728",
                     "r": "0xa983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e3093",
                     "s": "0x3a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2",
                     "v": 27,
                     "expiration": "1234",
                     "nonce": 123456
                  }
               }
            },
            "tx_abi": "S2zD1wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAASmWE3v3t1OyF5zNEryBo1K7WRyipg9Ip/CQu8O+rNxLAoD7vLFX0ovMB/q9aziKusZ4wkzoV2Y90nt/d46oB1313Sf4JuwsRogSFJM0Lx2hCKjfSAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAE0gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeJA",
            "tx_data": "0x4b6cc3d700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000004a6584defdedd4ec85e73344af2068d4aed64728a983d229fc242ef0efab3712c0a03eef2c55f4a2f301feaf5ace22aeb19e30933a15d98f749edfdde3aa01d77d7749fe09bb0b11a2048524cd0bc768422a37d2000000000000000000000000000000000000000000000000000000000000001b00000000000000000000000000000000000000000000000000000000000004d2000000000000000000000000000000000000000000000000000000000001e240",
            "ret": "no permission",
            "expectations": [
               {
                  "expect": {
                     "sub_account_id": "1",
                     "margin_type": 2
                  },
                  "name": "ExSubAccountMarginType"
               }
            ]
         }
      ]
   }
]